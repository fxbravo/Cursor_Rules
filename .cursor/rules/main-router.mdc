---
description: "Smart context router for hierarchical rule selection and classification"
globs: ["**/*"]
alwaysApply: true
---

# Smart Context Router

## WORKFLOW PRINCIPAL
1. ANALYSER contexte: urgence, scope, contraintes mentionn√©es
2. CLASSIFIER selon priorit√© hi√©rarchique et keywords  
3. ANNONCER: üéØ **CAT√âGORIE:** [nom] - [justification] - [confiance: %]
4. ROUTER vers r√®gle sp√©cialis√©e appropri√©e
5. APPLIQUER r√®gles sp√©cialis√©es avec contexte

## D√âTECTION CAT√âGORIES HI√âRARCHIQUE
**Priorit√© 1:** BUGFIX - Dysfonctionnement rapport√© ou erreur existante
**Priorit√© 2:** COMPLIANCE - Obligation l√©gale/audit/s√©curit√© document√©e
**Priorit√© 3:** EXPLORATION - Question technique √† valider avec POC  
**Priorit√© 4:** OPTIMIZATION - Performance mesur√©e insuffisante avec profiler
**Priorit√© 5:** MIGRATION - Changement technologique/version forc√©
**Priorit√© 6:** CLEANUP - Code existant √† nettoyer sans nouvelle fonctionnalit√©
**Priorit√© 7:** FEATURE - Toute nouvelle fonctionnalit√© (default fallback)

## KEYWORDS DETECTION
- **bugfix**: ["fix", "bug", "error", "broken", "not working", "fails"]
- **compliance**: ["security", "gdpr", "accessibility", "audit", "legal"]
- **exploration**: ["test", "try", "experiment", "prototype", "poc", "evaluate"]
- **optimization**: ["optimize", "performance", "speed", "faster", "slow"]
- **migration**: ["migrate", "upgrade", "update", "port", "switch to"]
- **cleanup**: ["refactor", "clean", "debt", "duplicate", "merge", "simplify"]
- **feature**: ["add", "new", "implement", "create", "build", "develop"]

## AMBIGU√èT√â RESOLUTION
- **Multiple matches**: Choisir priorit√© la plus haute et confirmer: "D√©tect√© [X] mais aussi [Y]. Je proc√®de avec [X] - correct ?"
- **No clear match**: Demander: "Votre demande pourrait √™tre: A) [option1] B) [option2] C) [option3]. Laquelle correspond ?"
- **Context needed**: Poser questions sp√©cifiques: "Pour mieux vous aider: 1) Y a-t-il un dysfonctionnement actuel ? 2) Voulez-vous ajouter quelque chose de nouveau ? 3) Cherchez-vous √† nettoyer l'existant ?"

## CONFIDENCE SYSTEM
- **High confidence >80%**: Proc√©der directement avec la r√®gle s√©lectionn√©e
- **Medium confidence 50-80%**: Confirmer choix avec utilisateur
- **Low confidence <50%**: Demander clarification obligatoire

## ROUTING VERS R√àGLES SP√âCIALIS√âES
Use @cleanup-rules.mdc for technical debt reduction and code simplification
Use @feature-rules.mdc for new functionality development with SOLID principles
Use @bugfix-rules.mdc for error correction and minimal fixes
Use @exploration-rules.mdc for POC development and technical validation
Use @migration-rules.mdc for technology changes and version upgrades
Use @optimization-rules.mdc for performance improvements with evidence
Use @compliance-rules.mdc for legal/security requirements implementation

## CONTRAINTES UNIVERSELLES
- **SOLID + DRY + KISS + YAGNI** s'appliquent √† toutes les cat√©gories
- **Strict mode**: Production code, zero tolerance for violations
- **Flexible mode**: Exploration/prototype, justified exceptions allowed
- **Context adaptation**: Adjusts strictness based on category and urgency signals

## VALIDATION OBLIGATOIRE
TOUJOURS annoncer la cat√©gorie d√©tect√©e avant de router vers une r√®gle sp√©cialis√©e.
Format: üéØ **CAT√âGORIE:** [nom] - [justification] - [confiance: X%]