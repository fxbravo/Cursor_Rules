{
    "system": {
      "version": "spec-llm/2025-context-aware",
      "lang": "fr",
      "telemetry": "off",
      "cot": "internal",
      "mode": "context-driven",
      "retry": { "max_cycle": 2 },
      "stack": ["NPM","Netlify","Supabase"]
    },
  
    "constraints": ["SOLID","DRY","KISS","YAGNI","NEVER_CREATE_IF_EXISTS"],
  
    "entry": {
      "require_classification": true,
      "announce_format": "ðŸŽ¯ CATÃ‰GORIE DÃ‰TECTÃ‰E: [cat] - [raison]",
      "steps": ["read","detect_keywords","classify","announce","apply_rules"]
    },
  
    "detect": {
      "cleanup": { "k": ["refactor","clean","debt","duplicate","simplify","merge"] },
      "feature": { "k": ["add","new","implement","create","develop","build","feature"] },
      "bugfix": { "k": ["fix","bug","error","broken","issue","not working","problem"] },
      "exploration": { "k": ["test","try","experiment","prototype","poc","evaluate","explore"] },
      "migration": { "k": ["migrate","upgrade","update","port","move to","switch to"] },
      "optimization": { "k": ["optimize","performance","speed","memory","faster","improve"] },
      "compliance": { "k": ["security","gdpr","accessibility","legal","audit","compliance"] }
    },
  
    "ambiguity": {
      "multiple": "dominant_objective",
      "none": "ask_clarification_with_options",
      "conflict": "list_interpretations_then_confirm",
      "default": "bugfix"
    },
  
    "contexts": {
      "cleanup": {
        "guardian": "strict_veto",
        "file_budget": "decrease_or_same",
        "forbidden": ["create_new_files","add_abstractions","invent_new_code","refactor_unrelated"],
        "must": ["identify_exact_problem","measure_before_after","reuse_good_code"],
        "success": "reduced_complexity"
      },
      "feature": {
        "guardian": "reasonable_oversight",
        "file_budget": "increase_justified",
        "must": ["follow_existing_patterns","justify_new_files"],
        "prefer": ["extend_existing_when_possible"],
        "success": "working_feature_without_debt"
      },
      "bugfix": {
        "guardian": "minimal_change_only",
        "file_budget": "no_increase",
        "prefer": ["modify_existing_only","smallest_possible_change"],
        "forbidden": ["refactor_while_fixing","formatting_noise"],
        "success": "bug_fixed_no_regression"
      },
      "exploration": {
        "guardian": "temporary_freedom",
        "file_budget": "temp_increase_ok",
        "must": ["mark_as_experimental","plan_cleanup_after"],
        "cleanup_trigger": "after_validation_decision",
        "success": "validated_or_cleaned"
      },
      "migration": {
        "guardian": "structured_transition",
        "file_budget": "temp_duplication_ok",
        "must": ["maintain_compatibility","migration_plan"],
        "phases": ["prepare","migrate","cleanup_old"],
        "success": "migration_complete_old_removed"
      },
      "optimization": {
        "guardian": "measured_improvement",
        "file_budget": "increase_if_measured_gain",
        "must": ["benchmark_before","measure_after"],
        "forbidden": ["optimize_without_metrics"],
        "success": "proven_performance_gain"
      },
      "compliance": {
        "guardian": "necessary_additions_only",
        "file_budget": "increase_allowed",
        "must": ["legal_requirement_proof","minimal_implementation"],
        "success": "compliance_minimal_impact"
      }
    },
  
    "workflow": {
      "classify": "detect_category_and_announce",
      "apply": "enforce_context_rules",
      "execute": "implement_under_context_guidelines",
      "validate": "verify_success_metrics"
    },
  
    "safeguards": {
      "debt": [
        "no_action_without_clear_problem",
        "prefer_modification_over_creation",
        "measure_complexity_impact",
        "changing_working_code_requires_strong_justification"
      ],
      "quality": [
        "file<=800","class<=300","func<=50",
        "tests_pass_after_changes",
        "no_dead_code"
      ],
      "ops": [
        "run_lint_test_build_after_edits",
        "avoid_long_running_without_background",
        "no_sensitive_leaks_in_logs"
      ],
      "types": [
        "no_explicit_any_in_prod",
        "tests_any_warn_only",
        "prefer_unknown+typeguards"
      ]
    },
  
    "outputs": {
      "CategoryDetection": {
        "required": ["category","justification","keywords_found"],
        "limits": { "justification_maxlen": 100 }
      },
      "ActionPlan": {
        "required": ["actions","file_impact","risk_level"],
        "enums": {
          "file_impact": ["decrease","same","increase_justified","increase_temporary"],
          "risk_level": ["low","medium","high"]
        }
      }
    },
  
    "enforcement": {
      "category_detection": "mandatory_before_any_action",
      "rule_violation": "block_and_explain_why",
      "user_override": "allowed_with_explicit_risk_ack",
      "continuous_validation": "check_after_each_modification"
    }
  }
